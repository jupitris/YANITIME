<!DOCTYPE html>
<html>
<head>
  <title>YanitimeOnRails</title>
  <%= stylesheet_link_tag :all %>
  <%= javascript_include_tag :defaults %>
  <%= csrf_meta_tag %>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript">
    var geo;
    var map;

    function initialize() {
      var latlng = new google.maps.LatLng(36, 138);
      var opts = {
        zoom: 8,
       center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      map = new google.maps.Map($("#map")[0], opts);
      geo = new google.maps.Geocoder();

      $("#getLatlng").click(getLatlng);
   }

    function getLatlng() {
      var req = {
        address: $("#address").val()
      };
      geo.geocode(req, function(result, status) {
        if (status != google.maps.GeocoderStatus.OK) {
          alert(status);
          return;
        }

        var latlng = result[0].geometry.location;

        map.setCenter(latlng);

        var marker = new google.maps.Marker({
          position:latlng,
          map:map,
          title:latlng.toString(),
          draggable:false
        });

        google.maps.event.addListener(marker, 'click', function(event){
          marker.setTitle(event.latLng.toString());
        });

        $("#latlang").html($("#address").val() + " : " + latlang.toString());
     });
    }

    $(document).ready(function(){
      initialize();
    });
  </script>
</head>
<body>

<%= yield %>

</body>
</html>
